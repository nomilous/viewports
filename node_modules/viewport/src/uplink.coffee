if typeof define isnt 'function' then define = require('amdefine')(module)

define -> 

    service = 

        init: (config) ->

            service.group  = config.group
            service.type   = config.type
            service.socket = config.socket

            #
            # TODO: the following, according to type, later
            #   

            service.socket.on 'connect', ->

                console.log 'connect!!'

                service.socket.emit 'event:connect', 

                    mode:     'leaf',
                    globalId: 'something or other',
                    secret:   'SEEKRIT'

                service.socket.emit 'viewport:connect' 

                    group: service.group

            service.socket.on 'viewport:connect:ok', (data) -> 

                console.log 'viewport:connect:ok', data

            #
            # init returns subscriber for external use of uplink events
            #

            on: (event, callback) -> # TODO 


        emit: (event, data) -> service.socket.emit event, data
        on: (event, cb)-> service.socket.on event, cb
