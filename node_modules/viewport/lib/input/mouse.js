// Generated by CoffeeScript 1.4.0
var define;

if (typeof define !== 'function') {
  define = require('amdefine')(module);
}

define(function() {
  var dx, dy, prevX, prevY, service;
  prevX = prevY = null;
  dx = function(x) {
    var delta;
    if (!prevX) {
      prevX = x;
      return 0;
    }
    delta = x - prevX;
    prevX = x;
    return delta;
  };
  dy = function(y) {
    var delta;
    if (!prevY) {
      prevY = y;
      return 0;
    }
    delta = y - prevY;
    prevY = y;
    return delta;
  };
  return service = {
    init: function(config) {
      service.uplink = config.uplink;
      return document.addEventListener('mousemove', service.onEvent, false);
    },
    include: function(e) {
      var x, y;
      x = e.movementX || e.mozMovementX || e.webkitMovementX;
      if (typeof x === 'undefined') {
        x = dx(e.clientX);
      }
      y = e.movementY || e.mozMovementY || e.webkitMovementY;
      if (typeof y === 'undefined') {
        y = dy(e.clientY);
      }
      return {
        type: e.type,
        keyCode: e.keyCode || 0,
        movementX: x,
        movementY: y
      };
    },
    onEvent: function(e) {
      return service.uplink.emit('viewport:event', service.include(e));
    }
  };
});
