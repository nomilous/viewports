// Generated by CoffeeScript 1.4.0
var cache, cached, fs;

fs = require('fs');

cache = {};

cached = function(name, callback) {
  if (cache[name]) {
    callback(null, cache[name]);
    return;
  }
  switch (name) {
    case 'three':
      return fs.readFile(__dirname + '/../node_modules/three/three.js', function(err, data) {
        cache[name] = data;
        return callback(null, data);
      });
    case 'require':
      return fs.readFile(__dirname + '/../node_modules/requirejs/require.js', function(err, data) {
        cache[name] = data;
        return callback(null, data);
      });
    default:
      return fs.readFile(__dirname + ("/" + name + ".js"), function(err, data) {
        return callback(null, data);
      });
  }
};

module.exports = {
  scripts: function(req, res, next) {
    var match;
    if (match = req.url.match(/^\/viewport\/(.*).js$/)) {
      cached(match[1], function(err, data) {
        res.set('Content-Type', 'text/javascript');
        return res.send(data);
      });
      return;
    }
    return next();
  }
};
