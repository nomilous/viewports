// Generated by CoffeeScript 1.4.0
var DevelopmentCache, fs, path;

path = require('path');

fs = require('fs');

module.exports = DevelopmentCache = (function() {

  function DevelopmentCache() {}

  DevelopmentCache.prototype.route = function(conf) {
    var app, name, route, script, scripts, src, _i, _len, _results;
    app = conf.app;
    scripts = conf.scripts;
    src = conf.src;
    name = conf.name;
    _results = [];
    for (_i = 0, _len = scripts.length; _i < _len; _i++) {
      script = scripts[_i];
      route = "/" + name + "/" + script;
      console.log('create route GET %s', route);
      _results.push(app.get(route, function(req, res) {
        var file, match;
        match = req.path.match(new RegExp("^\/" + name + "\/(.*)"));
        file = path.join(src, match[1]);
        res.header({
          'Content-Type': 'text/javascript'
        });
        return fs.readFile(file, function(err, data) {
          if (!err) {
            return res.send(data);
          }
          return res.statusCode = 404;
        });
      }));
    }
    return _results;
  };

  return DevelopmentCache;

})();
