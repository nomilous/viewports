// Generated by CoffeeScript 1.4.0
var ViewportProxy;

module.exports = ViewportProxy = (function() {

  function ViewportProxy(sockets) {
    var _this = this;
    this.sockets = sockets;
    this.viewports = {};
    this.sockets.on('connection', function(socket) {
      socket.on('viewport:connect', function(data) {
        return _this.handleConnect(socket, data);
      });
      return socket.on('viewport:reconnect', function(data) {
        return _this.handleConnect(socket, data);
      });
    });
  }

  ViewportProxy.prototype.handleConnect = function(socket, data) {
    var name, primary, sessionid;
    console.log(data);
    name = data.name;
    sessionid = data.sessionid;
    if (this.viewports[name]) {
      primary = this.viewports[name]['primary'] === sessionid;
      return socket.emit('viewport:config', {
        primary: primary
      });
    }
    this.viewports[name] = {
      primary: sessionid
    };
    return socket.emit('viewport:config', {
      primary: true
    });
  };

  return ViewportProxy;

})();
